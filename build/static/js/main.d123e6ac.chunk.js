(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{29:function(e,t,n){e.exports=n(69)},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},63:function(e,t,n){},64:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),o=n.n(c),u=n(1),s=n(9),l=(n(40),n(27)),i=n(8),m=n(12),f={SET_POSTS:"SET_POSTS",ADD_POST:"ADD_POST"},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.SET_POSTS:return t.payload;case f.ADD_POST:return[].concat(Object(m.a)(e),[Object(i.a)({id:e.length+2},t.payload)]);default:return e}},p={SET_COMMENTS:"SET_COMMENTS",ADD_COMMENT:"ADD_COMMENT"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.SET_COMMENTS:return t.payload;case p.ADD_COMMENT:return[].concat(Object(m.a)(e),[Object(i.a)({id:e.length+2},t.payload)]);default:return e}},h={SET_USER:"SET_USER"},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.SET_USER:return t.payload;default:return e}},b={TOGGLE_LOADING:"TOGGLE_LOADING"},E=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case b.TOGGLE_LOADING:return!e;default:return e}},O=Object(s.c)({posts:d,comments:g,user:v,loading:E}),y=[l.a];var N=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,S=Object(s.e)(O,N(s.a.apply(void 0,y))),j=function(e){return JSON.parse(window.localStorage.getItem("localUser"))||window.localStorage.setItem("localUser",JSON.stringify(e)),{type:h.SET_USER,payload:e}},w=function(e){return{type:f.SET_POSTS,payload:e}},x=function(e){return{type:p.SET_COMMENTS,payload:e}},_=function(){return{type:b.TOGGLE_LOADING}},k=n(4),C=n.n(k),T=n(2),D=n.n(T),P=n(6),A=null,M=function(e){A="bearer ".concat(e)},U={getPosts:function(){var e=Object(P.a)(D.a.mark(function e(t){var n;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return M(t.token),n={headers:{Authorization:A}},e.abrupt("return",C.a.get("/posts/combined",n).then(function(e){return e.data.map(function(e){return{id:e.id,text:e.text,createdAt:e.createdAt,day:e.day,author:e.user.name}})}));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),addPost:function(e,t){M(t.token);var n={headers:{Authorization:A}};return C.a.post("/posts/add",e,n)}},L=null,I=function(e){L="bearer ".concat(e)},R=function(e){I(e.token);var t={headers:{Authorization:L}};return C.a.get("/comments/combined",t).then(function(e){return e.data.map(function(e){var t=e.id,n=e.text,a=e.createdAt,r=e.post_id,c=e.user;return{id:t,text:n,createdAt:a,post_id:r,group_id:e.group_id,author:c.name}})}).catch(function(e){return console.log(e)})},G=function(e,t){I(t.token);var n={headers:{Authorization:L}};return C.a.post("/comments/add",e,n)},z=function(e){return C.a.all([U.getPosts(e),R(e)]).then(C.a.spread(function(e,t){return{posts:e,comments:t}}))},J=(n(59),function(){var e=Object(u.c)(function(e){return e.user.group_name});return r.a.createElement("header",{className:"header"},r.a.createElement("h1",{className:"header-title"},"WKND"),r.a.createElement("div",{className:"header-group"},e))}),W=n(3),K=function(e){var t=e.handleMenu,n=e.day;return r.a.createElement("div",{className:"card-header"},r.a.createElement("h2",{className:"card-header-day"},n),r.a.createElement("button",{className:"add",onClick:t},"+"))},B=n(28),F=function(e){var t=e.onClick,n=e.children,a=e.className,c=e.type;return r.a.createElement("button",{onClick:t,className:a,type:c},n)};function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var H=r.a.createElement("title",null,"send"),V=r.a.createElement("path",{d:"M0 0l20 10-20 10v-20zM0 8v4l10-2-10-2z"}),Q=function(e){var t=e.svgRef,n=q(e,["svgRef"]);return r.a.createElement("svg",X({width:20,height:20,viewBox:"0 0 20 20",ref:t},n),H,V)},Y=r.a.forwardRef(function(e,t){return r.a.createElement(Q,X({svgRef:t},e))}),Z=(n.p,function(e){var t=e.onSubmit,n=e.className,a=e.value,c=e.onChange,o=e.label;return r.a.createElement("form",{className:"card-form ".concat(n),onSubmit:t},r.a.createElement(B.a,{placeholder:"Add new ".concat(o),value:a,onChange:function(e){return c(e.target.value)},className:"card-form-input"}),r.a.createElement(F,{type:"submit",className:"card-form-button"},r.a.createElement(Y,{style:{fill:a?"hsl(184, 40%, 50%)":"hsl(0,0%,100%,.25)"}})))}),$=(n(60),Object(u.b)(null,function(e){return{addNewPost:function(t){return e(function(e){return{type:f.ADD_POST,payload:e}}(t))}}})(function(e){var t=e.day,n=e.children,c=e.addNewPost,o=Object(a.useState)(""),s=Object(W.a)(o,2),l=s[0],m=s[1],f=Object(u.c)(function(e){return e.user});return r.a.createElement("div",{className:"card",id:t},r.a.createElement(K,{day:t}),n,r.a.createElement(Z,{onSubmit:function(e){if(e.preventDefault(),l){var n={text:l,day:t,user_id:f.id,group_id:1};U.addPost(n,f).then(function(){console.log(f),c(Object(i.a)({},n,{author:f.name})),m("")}).catch(function(e){return console.log("err",e.message)})}},className:"card-form-post",value:l,onChange:m,label:"post"}))})),ee=function(e){var t=e.comment,n=t.author,a=t.text;return r.a.createElement("div",{className:"card-comment"},r.a.createElement("h3",{className:"card-comment-author"},n),r.a.createElement("p",{className:"card-comment-text"},a))},te=Object(u.b)(null,function(e){return{addComment:function(t){return e(function(e){return{type:p.ADD_COMMENT,payload:e}}(t))}}})(function(e){var t=e.post,n=t.id,c=t.author,o=t.text,s=e.comments,l=e.addComment,m=Object(a.useState)(!1),f=Object(W.a)(m,2),d=f[0],p=f[1],g=Object(a.useState)(""),h=Object(W.a)(g,2),v=h[0],b=h[1],E=Object(u.c)(function(e){return e.user});return r.a.createElement("div",{className:"card-post"},r.a.createElement("h3",{className:"card-post-author"},c),r.a.createElement("p",{className:"card-post-text"},o),r.a.createElement("button",{onClick:function(){return p(function(e){return!e})},className:"card-post-comments-num"},s.length," comments"),r.a.createElement("div",{className:"card-post-comments"},r.a.createElement("div",{className:"card-post-comments_list"},d&&s.map(function(e){return r.a.createElement(ee,{key:e.id,comment:e})})),r.a.createElement(Z,{onSubmit:function(e){if(e.preventDefault(),v){var t={text:v,user_id:E.id,post_id:n,group_id:E.group_id};console.log("COMMENT",E),G(t,E).then(function(){l(Object(i.a)({},t,{author:E.name})),b("")})}},className:"card-form-comment",value:v,onChange:b,label:"comment"})))}),ne=function(){var e=Object(u.c)(function(e){return e.posts}),t=Object(u.c)(function(e){return e.comments});return Object(a.useEffect)(function(){console.log("hey hey hey hey",t)}),r.a.createElement("section",{className:"cardList"},r.a.createElement($,{day:"FRI"},e.filter(function(e){return"FRI"===e.day}).map(function(e){return r.a.createElement(te,{key:e.id,post:e,comments:t.filter(function(t){return t.post_id===e.id})})})),r.a.createElement($,{day:"SAT"},e.filter(function(e){return"SAT"===e.day}).map(function(e){return r.a.createElement(te,{key:e.id,post:e,comments:t.filter(function(t){return t.post_id===e.id})})})),r.a.createElement($,{day:"SUN"},e.filter(function(e){return"SUN"===e.day}).map(function(e){return r.a.createElement(te,{key:e.id,post:e,comments:t.filter(function(t){return t.post_id===e.id})})})))},ae=(n(61),function(){return r.a.createElement("h1",{className:"loading"},"Loading...")}),re={login:function(){var e=Object(P.a)(D.a.mark(function e(t,n){var a;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/login",{username:t,password:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),checkUser:function(){var e=Object(P.a)(D.a.mark(function e(t){var n;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/users",{username:t});case 2:if("taken"!==(n=e.sent).data){e.next=7;break}return e.abrupt("return",!0);case 7:if("not taken"!==n.data){e.next=9;break}return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),create:function(){var e=Object(P.a)(D.a.mark(function e(t,n,a,r){var c;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/users/add",{name:t,username:n,password:a,group_id:r});case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}},e)}));return function(t,n,a,r){return e.apply(this,arguments)}}()},ce=(n(62),function(e){var t=e.message;return r.a.createElement("div",{className:"errorMessage",style:{opacity:t?.8:0}},t||null)}),oe=(n(63),function(e){return r.a.createElement("div",{className:"formInput"},e.value&&r.a.createElement("label",{className:"formInput-label"},e.placeholder),r.a.createElement("input",Object.assign({className:"formInput-input"},e,{required:!0})))}),ue=Object(u.b)(null,function(e){return{setUser:function(t){return e(j(t))},setCurrentPosts:function(t){return e(w(t))},setCurrentComments:function(t){return e(x(t))},toggleLoading:function(){return e(_())}}})(function(e){var t=e.setCurrentPosts,n=e.setCurrentComments,c=e.setUser,o=e.toggleLoading,u=Object(a.useState)(""),s=Object(W.a)(u,2),l=s[0],i=s[1],m=Object(a.useState)(""),f=Object(W.a)(m,2),d=f[0],p=f[1],g=Object(a.useState)(null),h=Object(W.a)(g,2),v=h[0],b=h[1],E=function(){var e=Object(P.a)(D.a.mark(function e(a){var r,u,s,i;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.prev=1,e.next=4,re.login(l,d);case 4:if(!(r=e.sent)){e.next=16;break}return e.next=8,z(r);case 8:u=e.sent,s=u.posts,i=u.comments,c(r),t(s),n(i),o(),localStorage.setItem("localUser",JSON.stringify(r));case 16:e.next=23;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("ERROR",e.t0),b("Invalid username/password"),setTimeout(function(){b(null)},3e3);case 23:case"end":return e.stop()}},e,null,[[1,18]])}));return function(t){return e.apply(this,arguments)}}(),O=v?{borderColor:"red"}:null;return r.a.createElement("form",{onSubmit:E,className:"login-form"},r.a.createElement(oe,{type:"text",placeholder:"username",value:l,onChange:function(e){return i(e.target.value)},style:O}),r.a.createElement(oe,{type:"password",placeholder:"password",value:d,onChange:function(e){return p(e.target.value)},style:O}),r.a.createElement(F,{className:"login-button ".concat(l&&d?"glow":null)},"Login"),r.a.createElement(ce,{message:v}))}),se=(n(64),function(e){var t=e.show,n=e.children;return r.a.createElement("div",{className:"login ".concat(t?"show":null)},r.a.createElement("h1",{className:"login-title"},"WKND"),r.a.createElement(ue,null),n)}),le={check:function(){var e=Object(P.a)(D.a.mark(function e(t,n){var a;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/groups",{name:t,id:n});case 2:if("group found"!==(a=e.sent).data){e.next=7;break}return e.abrupt("return",!0);case 7:if("no group found"!==a.data){e.next=9;break}return e.abrupt("return",!1);case 9:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),create:function(){var e=Object(P.a)(D.a.mark(function e(t,n){var a;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/groups/add",{name:t,id:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()},ie=Object(u.b)(null,function(e){return{setUser:function(t){return e(j(t))},setPosts:function(t){return e(w(t))},setComments:function(t){return e(x(t))},toggleLoading:function(){return e(_())}}})(function(e){var t=e.setUser,n=e.setPosts,c=e.setComments,o=e.toggleLoading,u=Object(a.useState)(""),s=Object(W.a)(u,2),l=s[0],i=s[1],m=Object(a.useState)(""),f=Object(W.a)(m,2),d=f[0],p=f[1],g=Object(a.useState)(""),h=Object(W.a)(g,2),v=h[0],b=h[1],E=Object(a.useState)(""),O=Object(W.a)(E,2),y=O[0],N=O[1],S=Object(a.useState)(""),j=Object(W.a)(S,2),w=j[0],x=j[1],_=Object(a.useState)(""),k=Object(W.a)(_,2),C=k[0],T=k[1],A=Object(a.useState)(null),M=Object(W.a)(A,2),U=M[0],L=M[1],I=function(e){L(e),setTimeout(function(){L(null)},3e3)},R=function(){var e=Object(P.a)(D.a.mark(function e(a){var r;return D.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),e.prev=1,v===y){e.next=6;break}I("Passwords should match"),e.next=17;break;case 6:return e.next=8,re.checkUser(l);case 8:if(r=e.sent){e.next=16;break}return e.next=12,le.check(w,C);case 12:e.sent?re.create(d,l,v,C).then(function(e){return t(e),z(e)}).then(function(e){var t=e.posts,a=e.comments;n(t),c(a),o()}):I("Group does not exist"),e.next=17;break;case 16:r&&I("Username taken");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0);case 22:case"end":return e.stop()}},e,null,[[1,19]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("form",{className:"signup-form",onSubmit:R},r.a.createElement(oe,{type:"text",value:d,onChange:function(e){return p(e.target.value)},placeholder:"name"}),r.a.createElement(oe,{type:"text",placeholder:"username",value:l,onChange:function(e){return i(e.target.value)}}),r.a.createElement(oe,{type:"password",placeholder:"password",value:v,onChange:function(e){return b(e.target.value)}}),r.a.createElement(oe,{type:"password",placeholder:"confirm pw",value:y,onChange:function(e){return N(e.target.value)}}),r.a.createElement("div",{className:"signup-form-group"},r.a.createElement(oe,{type:"text",placeholder:"group name",value:w,onChange:function(e){return x(e.target.value)}}),r.a.createElement(oe,{type:"number",placeholder:"group id",value:C,onChange:function(e){return T(e.target.value)}})),r.a.createElement(F,{className:"signup-form-button ".concat(l&&v&&d&&y&&w&&C?"glow":null)},"Create"),r.a.createElement(ce,{message:U}))}),me=(n(65),function(e){var t=e.show,n=e.children;return r.a.createElement("main",{className:"signup ".concat(t?"show":null)},r.a.createElement("h1",{className:"signup-title"},"WKND"),r.a.createElement(ie,null),n)}),fe=(n(66),function(){var e=Object(a.useState)("login"),t=Object(W.a)(e,2),n=t[0],c=t[1];function o(){console.log("click"),"login"===n?c("sign up"):"sign up"===n&&c("login")}return r.a.createElement("div",{className:"userWrapper"},r.a.createElement(se,{show:"login"===n},r.a.createElement(F,{onClick:o,className:"userWrapper-button"},"Don't have an account?")),r.a.createElement(me,{show:"sign up"===n},r.a.createElement(F,{onClick:o,className:"userWrapper-button"},"Have an account?")))});var de=Object(u.b)(null,function(e){return{setUser:function(t){return e(j(t))},setPosts:function(t){return e(w(t))},setComments:function(t){return e(x(t))},toggleLoading:function(){return e(_())}}})(function(e){var t=e.setUser,n=e.setComments,c=e.setPosts,o=e.toggleLoading,s=Object(u.c)(function(e){return e.user}),l=Object(u.c)(function(e){return e.loading});return Object(a.useEffect)(function(){var e=JSON.parse(window.localStorage.getItem("localUser"));e&&(t(e),z(e).then(function(e){var t=e.posts,a=e.comments;c(t),n(a),o()}))},[t,c,n,o]),s?l?r.a.createElement(ae,null):r.a.createElement("div",{className:"App"},r.a.createElement(J,null),r.a.createElement(ne,null)):r.a.createElement(fe,null)});n(67),n(68);o.a.render(r.a.createElement(u.a,{store:S},r.a.createElement(de,null)),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.d123e6ac.chunk.js.map